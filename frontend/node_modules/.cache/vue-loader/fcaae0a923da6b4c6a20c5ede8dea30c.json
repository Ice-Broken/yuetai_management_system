{"remainingRequest":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\src\\views\\buyer\\upload-buyer.vue?vue&type=template&id=52c55846&scoped=true&ts=true","dependencies":[{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\src\\views\\buyer\\upload-buyer.vue","mtime":1690170404356},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\vue-loader-v16\\dist\\templateLoader.js","mtime":1688620975546},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688620971327},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1688620975546}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgICA8ZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImNvbnRhaW5lciI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImhhbmRsZS1ib3giPgogICAgICAgICAgICAgICAgPGVsLXVwbG9hZAogICAgICAgICAgICAgICAgICAgIGFjdGlvbj0iIyIKICAgICAgICAgICAgICAgICAgICA6bGltaXQ9IjEiCiAgICAgICAgICAgICAgICAgICAgYWNjZXB0PSIueGxzeCwgLnhscyIKICAgICAgICAgICAgICAgICAgICA6c2hvdy1maWxlLWxpc3Q9ImZhbHNlIgogICAgICAgICAgICAgICAgICAgIDpiZWZvcmUtdXBsb2FkPSJiZWZvcmVVcGxvYWQiCiAgICAgICAgICAgICAgICAgICAgOmh0dHAtcmVxdWVzdD0iaGFuZGxlTWFueSIKICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICA8ZWwtYnV0dG9uIGNsYXNzPSJtcjEwIiB0eXBlPSJzdWNjZXNzIj7mibnph4/lr7zlhaU8L2VsLWJ1dHRvbj4KICAgICAgICAgICAgICAgIDwvZWwtdXBsb2FkPgogICAgICAgICAgICAgICAgPGVsLWxpbmsgaHJlZj0iL3RlbXBsYXRlLnhsc3giIHRhcmdldD0iX2JsYW5rIj7kuIvovb3mqKHmnb88L2VsLWxpbms+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZWwtdGFibGUgOmRhdGE9InRhYmxlRGF0YSIgYm9yZGVyIGNsYXNzPSJ0YWJsZSIgaGVhZGVyLWNlbGwtY2xhc3MtbmFtZT0idGFibGUtaGVhZGVyIj4KICAgICAgICAgICAgICAgIDxlbC10YWJsZS1jb2x1bW4gcHJvcD0iaWQiIGxhYmVsPSJJRCIgd2lkdGg9IjU1IiB0ZXh0X2FsaWduPSJjZW50ZXIiPjwvZWwtdGFibGUtY29sdW1uPgogICAgICAgICAgICAgICAgPGVsLXRhYmxlLWNvbHVtbiBwcm9wPSJuYW1lIiBsYWJlbD0i5aeT5ZCNIj48L2VsLXRhYmxlLWNvbHVtbj4KICAgICAgICAgICAgICAgIDxlbC10YWJsZS1jb2x1bW4gcHJvcD0ic25vIiBsYWJlbD0i5a2m5Y+3Ij48L2VsLXRhYmxlLWNvbHVtbj4KICAgICAgICAgICAgICAgIDxlbC10YWJsZS1jb2x1bW4gcHJvcD0iY2xhc3MiIGxhYmVsPSLnj63nuqciPjwvZWwtdGFibGUtY29sdW1uPgogICAgICAgICAgICAgICAgPGVsLXRhYmxlLWNvbHVtbiBwcm9wPSJhZ2UiIGxhYmVsPSLlubTpvoQiPjwvZWwtdGFibGUtY29sdW1uPgogICAgICAgICAgICAgICAgPGVsLXRhYmxlLWNvbHVtbiBwcm9wPSJzZXgiIGxhYmVsPSLmgKfliKsiPjwvZWwtdGFibGUtY29sdW1uPgogICAgICAgICAgICA8L2VsLXRhYmxlPgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+Cg=="},{"version":3,"sources":["C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\src\\views\\buyer\\upload-buyer.vue"],"names":[],"mappings":";IACI,CAAC,CAAC,CAAC,CAAC;QACA,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAClB,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBACT,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;oBACnB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBACtB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC5B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC7B;oBACI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1D,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAChE,CAAC,CAAC,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClF,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACtF,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACzD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACxD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC1D,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACxD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC5D,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACd,CAAC,CAAC,CAAC,CAAC,CAAC;IACT,CAAC,CAAC,CAAC,CAAC,CAAC","file":"C:/Users/Rick/Desktop/yuetai_management_system/frontend/src/views/buyer/upload-buyer.vue","sourceRoot":"","sourcesContent":["<template>\n    <div>\n        <div class=\"container\">\n            <div class=\"handle-box\">\n                <el-upload\n                    action=\"#\"\n                    :limit=\"1\"\n                    accept=\".xlsx, .xls\"\n                    :show-file-list=\"false\"\n                    :before-upload=\"beforeUpload\"\n                    :http-request=\"handleMany\"\n                >\n                    <el-button class=\"mr10\" type=\"success\">批量导入</el-button>\n                </el-upload>\n                <el-link href=\"/template.xlsx\" target=\"_blank\">下载模板</el-link>\n            </div>\n            <el-table :data=\"tableData\" border class=\"table\" header-cell-class-name=\"table-header\">\n                <el-table-column prop=\"id\" label=\"ID\" width=\"55\" text_align=\"center\"></el-table-column>\n                <el-table-column prop=\"name\" label=\"姓名\"></el-table-column>\n                <el-table-column prop=\"sno\" label=\"学号\"></el-table-column>\n                <el-table-column prop=\"class\" label=\"班级\"></el-table-column>\n                <el-table-column prop=\"age\" label=\"年龄\"></el-table-column>\n                <el-table-column prop=\"sex\" label=\"性别\"></el-table-column>\n            </el-table>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\" name=\"import\">\nimport { UploadProps } from 'element-plus';\nimport { ref, reactive } from 'vue';\nimport * as XLSX from 'xlsx';\n\ninterface TableItem {\n    id: number;\n    name: string;\n    sno: string;\n    class: string;\n    age: string;\n    sex: string;\n}\n\nconst tableData = ref<TableItem[]>([]);\n// 获取表格数据\nconst getData = () => {\n    tableData.value = [\n        {\n            id: 1,\n            name: '小明',\n            sno: 'S001',\n            class: '一班',\n            age: '10',\n            sex: '男',\n        },\n        {\n            id: 2,\n            name: '小红',\n            sno: 'S002',\n            class: '一班',\n            age: '9',\n            sex: '女',\n        },\n    ];\n};\ngetData();\n\nconst importList = ref<any>([]);\nconst beforeUpload: UploadProps['beforeUpload'] = async (rawFile) => {\n    importList.value = await analysisExcel(rawFile);\n    return true;\n};\nconst analysisExcel = (file: any) => {\n    return new Promise(function (resolve, reject) {\n        const reader = new FileReader();\n        reader.onload = function (e: any) {\n            const data = e.target.result;\n            let datajson = XLSX.read(data, {\n                type: 'binary',\n            });\n\n            const sheetName = datajson.SheetNames[0];\n            const result = XLSX.utils.sheet_to_json(datajson.Sheets[sheetName]);\n            resolve(result);\n        };\n        reader.readAsBinaryString(file);\n    });\n};\n\nconst handleMany = async () => {\n    // 把数据传给服务器后获取最新列表，这里只是示例，不做请求\n    const list = importList.value.map((item: any, index: number) => {\n        return {\n            id: index,\n            name: item['姓名'],\n            sno: item['学号'],\n            class: item['班级'],\n            age: item['年龄'],\n            sex: item['性别'],\n        };\n    });\n    tableData.value.push(...list);\n};\n</script>\n\n<style scoped>\n.handle-box {\n    display: flex;\n    margin-bottom: 20px;\n}\n\n.table {\n    width: 100%;\n    font-size: 14px;\n}\n.mr10 {\n    margin-right: 10px;\n}\n</style>\n"]}]}