{"remainingRequest":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\src\\views\\buyer\\upload-buyer.vue?vue&type=style&index=0&id=52c55846&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\src\\views\\buyer\\upload-buyer.vue","mtime":1690172008171},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1688620975306},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":1688620975546},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1688620975454},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688620971327},{"path":"C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":1688620975546}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5oYW5kbGUtYm94IHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBtYXJnaW4tYm90dG9tOiAyMHB4Owp9CgoudGFibGUgewogICAgd2lkdGg6IDEwMCU7CiAgICBmb250LXNpemU6IDE0cHg7Cn0KLm1yMTAgewogICAgbWFyZ2luLXJpZ2h0OiAxMHB4Owp9Cg=="},{"version":3,"sources":["C:\\Users\\Rick\\Desktop\\yuetai_management_system\\frontend\\src\\views\\buyer\\upload-buyer.vue"],"names":[],"mappings":";AAyGA,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACR,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACb,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACvB;;AAEA,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACH,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACnB;AACA,CAAC,CAAC,CAAC,CAAC,EAAE;IACF,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACtB","file":"C:/Users/Rick/Desktop/yuetai_management_system/frontend/src/views/buyer/upload-buyer.vue","sourceRoot":"","sourcesContent":["<template>\n    <div>\n        <div class=\"container\">\n            <div class=\"handle-box\">\n                <el-upload\n                    action=\"#\"\n                    :limit=\"1\"\n                    accept=\".xlsx, .xls\"\n                    :show-file-list=\"false\"\n                    :before-upload=\"beforeUpload\"\n                    :http-request=\"handleMany\"\n                >\n                    <el-button class=\"mr10\" type=\"success\">批量导入</el-button>\n                </el-upload>\n                <el-link href=\"/template.xlsx\" target=\"_blank\">下载模板</el-link>\n            </div>\n            <el-table :data=\"tableData\" border class=\"table\" header-cell-class-name=\"table-header\">\n                <el-table-column prop=\"id\" label=\"ID\" width=\"55\" text_align=\"center\"></el-table-column>\n                <el-table-column prop=\"name\" label=\"姓名\"></el-table-column>\n                <el-table-column prop=\"sno\" label=\"学号\"></el-table-column>\n                <el-table-column prop=\"class\" label=\"班级\"></el-table-column>\n                <el-table-column prop=\"age\" label=\"年龄\"></el-table-column>\n                <el-table-column prop=\"sex\" label=\"性别\"></el-table-column>\n            </el-table>\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\" name=\"import\">\nimport { UploadProps } from 'element-plus';\nimport { ref, reactive } from 'vue';\nimport XLSX from 'xlsx';\n\ninterface TableItem {\n    id: number;\n    name: string;\n    sno: string;\n    class: string;\n    age: string;\n    sex: string;\n}\n\nconst tableData = ref<TableItem[]>([]);\n// 获取表格数据\nconst getData = () => {\n    tableData.value = [\n        {\n            id: 1,\n            name: '小明',\n            sno: 'S001',\n            class: '一班',\n            age: '10',\n            sex: '男',\n        },\n        {\n            id: 2,\n            name: '小红',\n            sno: 'S002',\n            class: '一班',\n            age: '9',\n            sex: '女',\n        },\n    ];\n};\ngetData();\n\nconst importList = ref<any>([]);\nconst beforeUpload: UploadProps['beforeUpload'] = async (rawFile) => {\n    importList.value = await analysisExcel(rawFile);\n    return true;\n};\nconst analysisExcel = (file: any) => {\n    return new Promise(function (resolve, reject) {\n        const reader = new FileReader();\n        reader.onload = function (e: any) {\n            const data = e.target.result;\n            let datajson = XLSX.read(data, {\n                type: 'binary',\n            });\n\n            const sheetName = datajson.SheetNames[0];\n            const result = XLSX.utils.sheet_to_json(datajson.Sheets[sheetName]);\n            resolve(result);\n        };\n        reader.readAsBinaryString(file);\n    });\n};\n\nconst handleMany = async () => {\n    // 把数据传给服务器后获取最新列表，这里只是示例，不做请求\n    const list = importList.value.map((item: any, index: number) => {\n        return {\n            id: index,\n            name: item['姓名'],\n            sno: item['学号'],\n            class: item['班级'],\n            age: item['年龄'],\n            sex: item['性别'],\n        };\n    });\n    tableData.value.push(...list);\n};\n</script>\n\n<style scoped>\n.handle-box {\n    display: flex;\n    margin-bottom: 20px;\n}\n\n.table {\n    width: 100%;\n    font-size: 14px;\n}\n.mr10 {\n    margin-right: 10px;\n}\n</style>\n"]}]}